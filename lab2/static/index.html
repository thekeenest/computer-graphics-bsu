<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è ‚Ññ2 - –û–±—Ä–∞–±–æ—Ç–∫–∞ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</title>
    <link rel="stylesheet" href="/static/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>üñºÔ∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</h1>
            <p class="subtitle">–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ2 | –í–∞—Ä–∏–∞–Ω—Ç 11</p>
        </header>

        <div class="upload-section">
            <div class="upload-box">
                <input type="file" id="imageInput" accept="image/*" hidden>
                <label for="imageInput" class="upload-label">
                    <span class="upload-icon">üìÅ</span>
                    <span>–í—ã–±–µ—Ä–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</span>
                    <span class="upload-hint">–∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Å—é–¥–∞</span>
                </label>
            </div>
            <div id="fileName" class="file-name"></div>
        </div>

        <div class="tabs">
            <button class="tab-button active" data-tab="threshold">–ü–æ—Ä–æ–≥–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞</button>
            <button class="tab-button" data-tab="contrast">–ö–æ–Ω—Ç—Ä–∞—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</button>
            <button class="tab-button" data-tab="arithmetic">–ü–æ—ç–ª–µ–º–µ–Ω—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏</button>
            <button class="tab-button" data-tab="histogram">–≠–∫–≤–∞–ª–∏–∑–∞—Ü–∏—è –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã</button>
        </div>

        <!-- –ü–æ—Ä–æ–≥–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ -->
        <div id="threshold-tab" class="tab-content active">
            <div class="controls-panel">
                <h3>–õ–æ–∫–∞–ª—å–Ω–∞—è –ø–æ—Ä–æ–≥–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞</h3>
                
                <div class="control-group">
                    <label for="thresholdMethod">–ú–µ—Ç–æ–¥:</label>
                    <select id="thresholdMethod" class="control-select">
                        <option value="otsu">–ú–µ—Ç–æ–¥ –û—Ü—É (Otsu)</option>
                        <option value="adaptive_mean" selected>–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π (—Å—Ä–µ–¥–Ω–µ–µ)</option>
                        <option value="adaptive_gaussian">–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π (–ì–∞—É—Å—Å)</option>
                        <option value="niblack">–ú–µ—Ç–æ–¥ Niblack</option>
                    </select>
                </div>

                <div class="control-group" id="blockSizeGroup">
                    <label for="blockSize">–†–∞–∑–º–µ—Ä –±–ª–æ–∫–∞: <span id="blockSizeValue">11</span></label>
                    <input type="range" id="blockSize" min="3" max="51" step="2" value="11" class="control-slider">
                    <small>–†–∞–∑–º–µ—Ä –ª–æ–∫–∞–ª—å–Ω–æ–π –æ–∫—Ä–µ—Å—Ç–Ω–æ—Å—Ç–∏ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ—á–µ—Ç–Ω—ã–º)</small>
                </div>

                <div class="control-group" id="cConstantGroup">
                    <label for="cConstant">–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞ C: <span id="cConstantValue">2.0</span></label>
                    <input type="range" id="cConstant" min="0" max="20" step="0.5" value="2" class="control-slider">
                    <small>–í—ã—á–∏—Ç–∞–µ—Ç—Å—è –∏–∑ –ø–æ—Ä–æ–≥–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è</small>
                </div>

                <div class="control-group" id="kNiblackGroup" style="display:none;">
                    <label for="kNiblack">–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç k: <span id="kNiblackValue">-0.2</span></label>
                    <input type="range" id="kNiblack" min="-1" max="1" step="0.05" value="-0.2" class="control-slider">
                    <small>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è</small>
                </div>

                <button id="applyThreshold" class="apply-button">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
            </div>
        </div>

        <!-- –ö–æ–Ω—Ç—Ä–∞—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ -->
        <div id="contrast-tab" class="tab-content">
            <div class="controls-panel">
                <h3>–õ–∏–Ω–µ–π–Ω–æ–µ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</h3>
                <p class="formula">–§–æ—Ä–º—É–ª–∞: <code>–Ω–æ–≤—ã–π_–ø–∏–∫—Å–µ–ª—å = Œ± √ó —Å—Ç–∞—Ä—ã–π_–ø–∏–∫—Å–µ–ª—å + Œ≤</code></p>
                
                <div class="control-group">
                    <label for="alpha">–ö–æ–Ω—Ç—Ä–∞—Å—Ç (Œ±): <span id="alphaValue">1.0</span></label>
                    <input type="range" id="alpha" min="0.1" max="3.0" step="0.1" value="1.0" class="control-slider">
                    <small>Œ± > 1: —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–∞, Œ± < 1: —É–º–µ–Ω—å—à–µ–Ω–∏–µ</small>
                </div>

                <div class="control-group">
                    <label for="beta">–Ø—Ä–∫–æ—Å—Ç—å (Œ≤): <span id="betaValue">0</span></label>
                    <input type="range" id="beta" min="-100" max="100" step="5" value="0" class="control-slider">
                    <small>Œ≤ > 0: —Å–≤–µ—Ç–ª–µ–µ, Œ≤ < 0: —Ç–µ–º–Ω–µ–µ</small>
                </div>

                <button id="applyContrast" class="apply-button">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
            </div>
        </div>

        <!-- –ü–æ—ç–ª–µ–º–µ–Ω—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ -->
        <div id="arithmetic-tab" class="tab-content">
            <div class="controls-panel">
                <h3>–ü–æ—ç–ª–µ–º–µ–Ω—Ç–Ω—ã–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏</h3>
                
                <div class="control-group">
                    <label for="operation">–û–ø–µ—Ä–∞—Ü–∏—è:</label>
                    <select id="operation" class="control-select">
                        <option value="add">–°–ª–æ–∂–µ–Ω–∏–µ (+)</option>
                        <option value="subtract">–í—ã—á–∏—Ç–∞–Ω–∏–µ (‚àí)</option>
                        <option value="multiply">–£–º–Ω–æ–∂–µ–Ω–∏–µ (√ó)</option>
                        <option value="divide">–î–µ–ª–µ–Ω–∏–µ (√∑)</option>
                    </select>
                </div>

                <div class="control-group">
                    <label for="operationValue">–ó–Ω–∞—á–µ–Ω–∏–µ: <span id="operationValueDisplay">50</span></label>
                    <input type="range" id="operationValue" min="0" max="200" step="5" value="50" class="control-slider">
                    <small>–ó–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∫ –∫–∞–∂–¥–æ–º—É –ø–∏–∫—Å–µ–ª—é</small>
                </div>

                <button id="applyArithmetic" class="apply-button">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
            </div>
        </div>

        <!-- –≠–∫–≤–∞–ª–∏–∑–∞—Ü–∏—è –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã -->
        <div id="histogram-tab" class="tab-content">
            <div class="controls-panel">
                <h3>–≠–∫–≤–∞–ª–∏–∑–∞—Ü–∏—è –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã</h3>
                
                <div class="control-group">
                    <label for="histMethod">–ú–µ—Ç–æ–¥:</label>
                    <select id="histMethod" class="control-select">
                        <option value="rgb">RGB (–≤—Å–µ –∫–∞–Ω–∞–ª—ã)</option>
                        <option value="hsv_v">HSV (—Ç–æ–ª—å–∫–æ —è—Ä–∫–æ—Å—Ç—å V)</option>
                        <option value="hls_l">HLS (—Ç–æ–ª—å–∫–æ —Å–≤–µ—Ç–ª–æ—Ç–∞ L)</option>
                    </select>
                    <small id="methodDescription" class="method-description">
                        –≠–∫–≤–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞–∂–¥–æ–≥–æ –∫–∞–Ω–∞–ª–∞ RGB –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
                    </small>
                </div>

                <button id="applyHistogram" class="apply-button">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
            </div>
        </div>

        <div class="results-section" id="resultsSection" style="display:none;">
            <div class="images-container">
                <div class="image-box">
                    <h4>–ò—Å—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</h4>
                    <img id="originalImage" alt="Original">
                    <div class="histogram-container">
                        <canvas id="originalHistogram"></canvas>
                    </div>
                </div>

                <div class="image-box">
                    <h4>–†–µ–∑—É–ª—å—Ç–∞—Ç</h4>
                    <img id="resultImage" alt="Result">
                    <div class="histogram-container">
                        <canvas id="resultHistogram"></canvas>
                    </div>
                </div>
            </div>

            <div class="info-panel" id="infoPanel"></div>

            <div class="actions">
                <button id="downloadResult" class="action-button">üíæ –°–∫–∞—á–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç</button>
                <button id="resetImage" class="action-button secondary">üîÑ –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤–æ–µ</button>
            </div>
        </div>

        <div class="loader" id="loader" style="display:none;">
            <div class="spinner"></div>
            <p>–û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è...</p>
        </div>
    </div>

    <footer>
        <p>–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ2 | –ë–ì–£ | –ö–æ–º–ø—å—é—Ç–µ—Ä–Ω–∞—è –≥—Ä–∞—Ñ–∏–∫–∞</p>
    </footer>

    <script src="/static/script.js"></script>
</body>
</html>
